(function(t){function m(b){function f(a,c){for(var b in a)"undefined"==typeof c[b]&&(c[b]=a[b]);return c}var a=this,e={title:"Lxh Terminal",locale:"en",langs:{en:{},"zh-CN":{}},start:"Welcome to %s.",end:[{content:'Type "help" to get a supporting command list.',style:"system"}],messages:[],commands:{},element:".terminal-container",loadingTime:500,width:"100%",height:"500px",histories:[]},d={help:{handle:function(c,b,d){c=a.commands();var g;d="";var p=a.builder;for(g in c)"help"!=g&&(d+=a.builder.line("---\x3e "+
    k.trans(c[g].description),"success",g));b(p.row(p.cmd(k.trans("Here is a list of supporting command.")))+d)}},author:{description:"About author.",handle:[{content:"Jiang QingHua.",style:"info",label:"Name:"},{content:(new Date).getFullYear()-1993,style:"info",label:"Age:"},{content:"Under Construction.",style:"info",label:"Website:"},{content:"841324345@qq.com",style:"info",label:"Email:"},{content:'<a href="https://github.com/jqhph" target="_blank">https://github.com/jqhph</a>',style:"info",label:"Github:"},
    {content:"841324345",style:"info",label:"QQ:"}]},readme:{description:"About this project.",handle:[{content:"This is a component that emulates a command terminal in JQuery"}]},document:{description:"Document of this project.",handle:[{content:'<a href="https://github.com/jqhph/jquery-terminal-emulator" target="_blank">https://github.com/jqhph/jquery-terminal-emulator</a>',style:"primary"}]},version:{description:"Return this project version.",handle:[{content:"v1.0.4",style:"system"}]}},c=-1;this.element=
    function(){var a=b.element||e.element;return"object"==typeof a?a:$(a)};this.addHistory=function(a){a&&b.histories.unshift(a)};this.prevHistory=function(){c>=b.histories.length-1&&(c=b.histories.length-2);c++;return b.histories[c]||""};this.nextHistory=function(){if(1>c)return c=-1,"";c--;return b.histories[c]||""};this.resetHistoryIndex=function(){c=-1};this.messages=function(){return b.messages};this.commands=function(){return b.commands};this.command=function(c,g,d){b.commands[c]={description:g,
    handle:d};a.supportingCommands[c]=1};this.option=function(a,c){return a?b[a]||c:b};(function(){b=b||{};b=f(e,b);b.commands=f(d,b.commands);this.$el=this.element();this.translator=k;k.set(b.langs[b.locale]);this.builder=new u(this);var a={},c;for(c in b.commands)a[c]=1;this.supportingCommands=a;this.render()}).call(this)}function v(){function b(a,b){var c=$.Deferred();d.loading();setTimeout(function(){b(a,c.resolve,c.reject)},1);return c.promise()}function f(c){c.$win=$(".terminal-window");c.$el.off("click").on("click",
    function(b){var d=c.$el.find(".input-box"),e=c.$el.find(".terminal-last-line");d.focus();d.off("click").click(function(){var a=this;d.focus();setTimeout(function(){if(document.selection){var c=a.createTextRange();c.moveStart("character",1E3);c.collapse();c.select()}else"number"==typeof a.selectionStart&&"number"==typeof a.selectionEnd&&(a.selectionStart=a.selectionEnd=1E3)},30)});d.off("keyup").on("keyup",function(b){var g=this.value;switch(b.keyCode){case 13:e.remove();c.addHistory(g);c.input(g);
        break;case 38:return g=c.prevHistory(),d.val(g),a(d,g);case 40:return g=c.nextHistory(),d.val(g),a(d,g);default:return a(d,g)}})}.bind(this)).click()}function a(a,b){return a.parent().find(".__content").html(b)}function e(a,b,g){function c(){d.append(d.builder.line(k.trans(e.content),e.style,e.label,g));(e=a.shift())?d.loading(c):b(!0)}var e=a.shift();e?d.loading(c):b()}var d;m.prototype={render:function(){var a='<div class="terminal-w-c" style="position:absolute;top:0;left:0;right:0;overflow:auto;margin-top:25px;z-index:1;max-height:'+
    this.option("height")+'" ><div class="terminal-window" >';d=this;this.html='<div class="terminal"><div style="position:relative">'+this.builder.header()+a+this.builder.body()+"</div></div></div></div>";this.$el.html(this.html);f(this);setTimeout(function(){d.$el.find(".terminal").css({width:d.option("width")});d.$el.find(".terminal-window").css({"min-height":d.option("height")})},2);e(d.messages(),function(){e(d.option("end"),function(a){a?d.loading(function(a){a.append(a.builder.lastLine())}):d.append(d.builder.lastLine())})},
    !0);this.afterRender()},afterRender:function(){d.$el.find(".terminal").css({height:d.option("height"),"margin-bottom":"25px"})},scrollTop:function(){this.$el.find(".end-input").remove();this.$win.append('<input class="end-input" value="test" style="opacity:0;height:0;line-height:0">');this.$el.find(".end-input").focus()},loading:function(a){var c=this,b=this.builder;c.append(b.row(b.span("loading","...")));a&&setTimeout(function(){c.done();a(c)},c.option("loadingTime"))},done:function(){this.$el.find(".loading").remove()},
    append:function(a){this.$win.append(a);this.scrollTop();f(this)},input:function(a){var b=this.builder;a=this.run(a);null!==a&&(a=!1!==a?b.line(a):"",this.append(a+b.lastLine()))},run:function(a){function c(a){if("object"!=typeof a)return a;var b="";for(l in a)b+=h.systemline(a[l].content,a[l].style,a[l].label);return b}var e=a.split(" "),f=[],l,h=this.builder,m=this.commands();for(l in e)e[l]&&f.push(e[l]);e=f.shift();if(!e)return"";if("undefined"==typeof this.supportingCommands[e])return this.append(h.line(a)+
        h.line(k.trans("Unknown Command."),"error")+h.line(k.trans('Type "help" to get a supporting command list.'),"system")),!1;var n=h.line(a);e=m[e];switch(typeof e.handle){case "undefined":return n;case "object":return n+c(e.handle);case "function":return b(f,e.handle).then(function(a){d.done();d.append(h.line(n+c(a))+h.lastLine())},function(a){d.done();d.append(h.line(n)+h.line(k.trans("Something went wrong!"),"error")+h.systemline(c(a))+h.lastLine())}),null;default:return n+e.handle}}}}function q(){var b=
    {};this.get=function(f){return String(b[f]||f)};this.set=function(f){b=f||b};b=b||{}}function u(b){var f=b.option("title");return{header:function(){return'<div class="header"><h4>'+f+'</h4><ul class="shell-dots"><li class="red"></li><li class="yellow"></li><li class="green"></li></ul></div>'},body:function(){var a=k.trans(b.option("start"),f);return this.row(a)+this.row(this.prompt()+this.cmd("cd "+f))},lastLine:function(){return this.row(function(a){return a.prompt(f+"/ ")+a.span("content")+a.span("cursor",
    "&nbsp;")+a.input()},".terminal-last-line".replace(".",""))},list:function(a,b){if(!a||"undefined"==typeof a.push)return a;b=b||"";var d="",c;for(c in a)d+="<li><pre>"+a[c]+"</pre></li>";b&&(b=this.span("",b));return b+"<ul>"+d+"</ul>"},line:function(a,b,d,c){var e="";b||d||c||(e=this.prompt()+" ");b&&!d&&(d=b);return this.row(e+this.span(b,d)+" "+this.cmd(a))},systemline:function(a,b,d){b&&!d&&(d=b);return this.row(this.span(b,d)+" "+this.cmd(a))},input:function(){return'<input type="text" class="input-box" />'},
    row:function(a,b){return'<p class="'+(b||"")+'">'+r.call(this,a)+"</p>"},prompt:function(a){return this.span("prompt",a)},cmd:function(a){"object"==typeof a&&"object"==typeof a.list&&"undefined"!=typeof a.list.push&&(a=this.list(a.list,a.title));return this.span("cmd",a)},success:function(a){return this.span("success",a)},info:function(a){return this.span("info",a)},warning:function(a){return this.span("warning",a)},error:function(a){return this.span("error",a)},system:function(a){return this.span("system",
        a)},span:function(a,b){"content"==a&&(a="__"+a);a=(a=a||"")?-1==a.indexOf("#")&&-1==a.indexOf("rgb")?'class="'+a+'"':'style="color:'+a+'"':a;return"<span "+a+">"+k.trans(r.call(this,b))+"</span>"}}}function r(b){return"function"==typeof b?b(this):b||""}var k;q.prototype={trans:function(b,f){if("object"==typeof b)return b;f=f&&"function"==typeof f.splice?f:[f];var a=-1;return this.get(b).replace(/%s/ig,function(b,d){a++;return f[a]||""})}};(function(){k=new q;v();t.LxhTerminal=m;$.fn.lxhTerminal=function(b){b=
    b||{};b.element=$(this);return new m(b)}})()})(window);
